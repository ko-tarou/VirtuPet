{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tkota\\\\project_k\\\\hackthon\\\\Web\\\\hackthon2024_11_30\\\\VirtuPet\\\\src\\\\pages\\\\select.jsx\";\nimport React, { useEffect, useRef } from 'react';\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { useNavigate } from 'react-router-dom';\nimport '../pages/styles/select.css'; // CSSファイルをインポート\n\nconst Select = () => {\n  const mountRef = useRef(null);\n  const buttonRefs = useRef([]);\n  useEffect(() => {\n    const mountNode = mountRef.current;\n\n    // シーン、カメラ、レンダラーの設定\n    const scene = new THREE.Scene();\n    const camera = new THREE.PerspectiveCamera(30, window.innerWidth / window.innerHeight, 0.1, 1000);\n    const renderer = new THREE.WebGLRenderer({\n      alpha: true\n    });\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.setClearColor(0x000000, 0);\n    mountNode.appendChild(renderer.domElement);\n    const light = new THREE.AmbientLight(0xffffff, 3); // 環境光\n    scene.add(light);\n    const loader = new GLTFLoader();\n\n    // 動的なモデル位置調整関数\n    const positionModelAboveButton = (buttonIndex, model) => {\n      const button = buttonRefs.current[buttonIndex];\n      if (button) {\n        const buttonRect = button.getBoundingClientRect();\n        const buttonCenterX = buttonRect.left + buttonRect.width / 2;\n        const buttonCenterY = buttonRect.top + buttonRect.height / 2;\n        const normalizedX = buttonCenterX / window.innerWidth * 2 - 1;\n        const normalizedY = -(buttonCenterY / window.innerHeight) * 2 + 1;\n        const vector = new THREE.Vector3(normalizedX, normalizedY, 0.5).unproject(camera);\n        model.position.set(vector.x, vector.y, 0);\n      }\n    };\n\n    // モデルをロードして配置\n    const loadModel = (path, buttonIndex) => {\n      loader.load(path, gltf => {\n        const model = gltf.scene;\n        model.position.z = 0; // 初期Z座標\n\n        positionModelAboveButton(buttonIndex, model);\n\n        // アニメーションの設定\n        const mixer = new THREE.AnimationMixer(model);\n        gltf.animations.forEach(clip => {\n          mixer.clipAction(clip).play();\n        });\n        scene.add(model);\n\n        // アニメーション更新\n        const clock = new THREE.Clock();\n        const animate = () => {\n          const delta = clock.getDelta();\n          mixer.update(delta);\n          renderer.render(scene, camera);\n          requestAnimationFrame(animate);\n        };\n        animate();\n      }, undefined, error => {\n        console.error(`${path} の読み込みエラー:`, error);\n      });\n    };\n\n    // モデルをロード\n    loadModel('/models/kitune move big.glb', 0);\n    loadModel('/models/inudake move big.glb', 1);\n    loadModel('/models/pengin move big.glb', 2);\n\n    // リサイズ時にモデル位置を更新\n    const handleResize = () => {\n      renderer.setSize(window.innerWidth, window.innerHeight);\n      camera.aspect = window.innerWidth / window.innerHeight;\n      camera.updateProjectionMatrix();\n    };\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      mountNode.removeChild(renderer.domElement);\n    };\n  }, []);\n  const navigate = useNavigate();\n  const handleView = () => {\n    navigate('/view');\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-select\",\n    style: {\n      position: 'relative'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"button-container\",\n    ref: el => buttonRefs.current[0] = el,\n    style: {\n      position: 'absolute',\n      left: '10%',\n      top: '70%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"chara1\",\n    onClick: handleView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, \"\\u304D\\u3064\\u306D\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"button-container\",\n    ref: el => buttonRefs.current[1] = el,\n    style: {\n      position: 'absolute',\n      left: '45%',\n      top: '70%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"chara2\",\n    onClick: handleView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }\n  }, \"\\u3044\\u306C\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"button-container\",\n    ref: el => buttonRefs.current[2] = el,\n    style: {\n      position: 'absolute',\n      left: '80%',\n      top: '70%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"chara3\",\n    onClick: handleView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, \"\\u30DA\\u30F3\\u30AE\\u30F3\")), /*#__PURE__*/React.createElement(\"div\", {\n    ref: mountRef,\n    style: {\n      width: '100vw',\n      height: '100vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }\n  }));\n};\nexport default Select;","map":{"version":3,"names":["React","useEffect","useRef","THREE","GLTFLoader","useNavigate","Select","mountRef","buttonRefs","mountNode","current","scene","Scene","camera","PerspectiveCamera","window","innerWidth","innerHeight","renderer","WebGLRenderer","alpha","setSize","setClearColor","appendChild","domElement","light","AmbientLight","add","loader","positionModelAboveButton","buttonIndex","model","button","buttonRect","getBoundingClientRect","buttonCenterX","left","width","buttonCenterY","top","height","normalizedX","normalizedY","vector","Vector3","unproject","position","set","x","y","loadModel","path","load","gltf","z","mixer","AnimationMixer","animations","forEach","clip","clipAction","play","clock","Clock","animate","delta","getDelta","update","render","requestAnimationFrame","undefined","error","console","handleResize","aspect","updateProjectionMatrix","addEventListener","removeEventListener","removeChild","navigate","handleView","createElement","className","style","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","el","onClick"],"sources":["C:/Users/tkota/project_k/hackthon/Web/hackthon2024_11_30/VirtuPet/src/pages/select.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport * as THREE from 'three';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../pages/styles/select.css'; // CSSファイルをインポート\r\n\r\nconst Select = () => {\r\n  const mountRef = useRef(null);\r\n  const buttonRefs = useRef([]);\r\n\r\n  useEffect(() => {\r\n    const mountNode = mountRef.current;\r\n\r\n    // シーン、カメラ、レンダラーの設定\r\n    const scene = new THREE.Scene();\r\n    const camera = new THREE.PerspectiveCamera(\r\n      30,\r\n      window.innerWidth / window.innerHeight,\r\n      0.1,\r\n      1000\r\n    );\r\n    const renderer = new THREE.WebGLRenderer({ alpha: true });\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    renderer.setClearColor(0x000000, 0);\r\n    mountNode.appendChild(renderer.domElement);\r\n\r\n    const light = new THREE.AmbientLight(0xffffff, 3); // 環境光\r\n    scene.add(light);\r\n\r\n    const loader = new GLTFLoader();\r\n\r\n    // 動的なモデル位置調整関数\r\n    const positionModelAboveButton = (buttonIndex, model) => {\r\n      const button = buttonRefs.current[buttonIndex];\r\n      if (button) {\r\n        const buttonRect = button.getBoundingClientRect();\r\n        const buttonCenterX = buttonRect.left + buttonRect.width / 2;\r\n        const buttonCenterY = buttonRect.top + buttonRect.height / 2;\r\n\r\n        const normalizedX = (buttonCenterX / window.innerWidth) * 2 - 1;\r\n        const normalizedY = -(buttonCenterY / window.innerHeight) * 2 + 1;\r\n\r\n        const vector = new THREE.Vector3(normalizedX, normalizedY, 0.5).unproject(camera);\r\n\r\n        model.position.set(vector.x, vector.y, 0);\r\n      }\r\n    };\r\n\r\n    // モデルをロードして配置\r\n    const loadModel = (path, buttonIndex) => {\r\n      loader.load(\r\n        path,\r\n        (gltf) => {\r\n          const model = gltf.scene;\r\n          model.position.z = 0; // 初期Z座標\r\n\r\n          positionModelAboveButton(buttonIndex, model);\r\n\r\n          // アニメーションの設定\r\n          const mixer = new THREE.AnimationMixer(model);\r\n          gltf.animations.forEach((clip) => {\r\n            mixer.clipAction(clip).play();\r\n          });\r\n\r\n          scene.add(model);\r\n\r\n          // アニメーション更新\r\n          const clock = new THREE.Clock();\r\n          const animate = () => {\r\n            const delta = clock.getDelta();\r\n            mixer.update(delta);\r\n            renderer.render(scene, camera);\r\n            requestAnimationFrame(animate);\r\n          };\r\n          animate();\r\n        },\r\n        undefined,\r\n        (error) => {\r\n          console.error(`${path} の読み込みエラー:`, error);\r\n        }\r\n      );\r\n    };\r\n\r\n    // モデルをロード\r\n    loadModel('/models/kitune move big.glb', 0);\r\n    loadModel('/models/inudake move big.glb', 1);\r\n    loadModel('/models/pengin move big.glb', 2);\r\n\r\n    // リサイズ時にモデル位置を更新\r\n    const handleResize = () => {\r\n      renderer.setSize(window.innerWidth, window.innerHeight);\r\n      camera.aspect = window.innerWidth / window.innerHeight;\r\n      camera.updateProjectionMatrix();\r\n    };\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n      mountNode.removeChild(renderer.domElement);\r\n    };\r\n  }, []);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const handleView = () => {\r\n    navigate('/view');\r\n  };\r\n\r\n  return (\r\n    <div className=\"container-select\" style={{ position: 'relative' }}>\r\n      <div\r\n        className=\"button-container\"\r\n        ref={(el) => (buttonRefs.current[0] = el)}\r\n        style={{ position: 'absolute', left: '10%', top: '70%' }}\r\n      >\r\n        <button className=\"chara1\" onClick={handleView}>きつね</button>\r\n      </div>\r\n      <div\r\n        className=\"button-container\"\r\n        ref={(el) => (buttonRefs.current[1] = el)}\r\n        style={{ position: 'absolute', left: '45%', top: '70%' }}\r\n      >\r\n        <button className=\"chara2\" onClick={handleView}>いぬ</button>\r\n      </div>\r\n      <div\r\n        className=\"button-container\"\r\n        ref={(el) => (buttonRefs.current[2] = el)}\r\n        style={{ position: 'absolute', left: '80%', top: '70%' }}\r\n      >\r\n        <button className=\"chara3\" onClick={handleView}>ペンギン</button>\r\n      </div>\r\n      <div ref={mountRef} style={{ width: '100vw', height: '100vh' }}></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Select;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}